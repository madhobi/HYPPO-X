
<!--**************************************************************************************************
 Copyright Â© 2016-2017 Md.Kamruzzaman. All rights reserved.
 The generated code is released under following licenses:
 GNU GENERAL PUBLIC LICENSE, Version 3, 29 June 2007
 --------------------------------------------------------------------------------------------------
 File name: single_filter_dap.h
 Objective: Plot pie chart to the topological object constructed by single filter function DAP
 Additional information: NA
 --------------------------------------------------------------------------------------------------
 Contributors                   Date            Task details
 -------------------------    ----------      --------------------
 Md. Kamruzzaman              02/16/2017      Initial version
 
 **************************************************************************************************-->

<html>
	<head>
		<script type="text/javascript">
			function drawText(_canvas, text, position, style){
				var context = _canvas.getContext('2d');

				context.font = style.font;//'bold 10pt Calibri';
				context.fillStyle = style.color;
  				context.fillText(text, (position.x1+position.x2)/2, (position.y1+position.y2)/2);
			}

			function drawPie(_canvas, position, data, _id, _offset){
				var total = 0;
				  for (obj of data) {
				    total += obj.value;
				  }

				  var ctx = _canvas.getContext('2d');
				  var previousRadian;
				  var middle = {
				    x: position.x-_offset.x,
				    y: _offset.y-position.y,
				    radius: position.rad,
				  };
				  
				   //background
				  ctx.beginPath();
				  ctx.arc(middle.x, middle.y, middle.radius, 0, 2 * Math.PI);
				  ctx.closePath();
				  ctx.stroke();
				  ctx.fillStyle = "black";
				  ctx.fill();
				   //end of background

				  for (obj of data) {
				    previousRadian = previousRadian || 0;
				    obj.percentage = parseInt((obj.value / total) * 100)
				    
				    ctx.beginPath();
				    ctx.fillStyle = obj.color;
				    obj.radian = (Math.PI * 2) * (obj.value / total);
				    ctx.moveTo(middle.x, middle.y);
				    ctx.arc(middle.x, middle.y, middle.radius - 2, previousRadian, previousRadian + obj.radian, false);
				    ctx.closePath();
				    ctx.fill();
				    ctx.save();
				    ctx.translate(middle.x, middle.y);
				    ctx.fillStyle = "white";
				    ctx.font = middle.radius / 10 + "px Arial";
				    ctx.rotate(previousRadian + obj.radian);
				  
				    ctx.restore();

				    previousRadian += obj.radian;
				  }

			}
		</script>
	</head>
	<body>
		<!-- Adjust the canvas width and height. It is a viewport. -->
		<canvas id="myCanvas" width="2100" height="290"></canvas>
		<script type="text/javascript">
			var canvas = document.getElementById('myCanvas');

			// Place the JSON data here which is generated in our main 'C++' project
 			// var data=JSON data
 			var data=[{id:62,p:{x:2036.000000,y:553.000000,rad:17.33}, d:[{label: "BK",value: 12,color: '#ff0000'},{label: "BN",value: 10,color: '#E67E22'},{label: "AN",value: 10,color: '#00ff00'},{label: "AK",value: 10,color: '#0000ff'}]},{id:15,p:{x:755.000000,y:544.000000,rad:17.66}, d:[{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:39,p:{x:1318.000000,y:546.000000,rad:16.66}, d:[{label: "BK",value: 6,color: '#ff0000'},{label: "BN",value: 20,color: '#E67E22'},{label: "AK",value: 5,color: '#0000ff'}]},{id:57,p:{x:1759.000000,y:718.000000,rad:15.33}, d:[{label: "AN",value: 10,color: '#00ff00'}]},{id:10,p:{x:546.000000,y:540.000000,rad:20.00}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'},{label: "AK",value: 20,color: '#0000ff'}]},{id:34,p:{x:1182.000000,y:685.000000,rad:15.33}, d:[{label: "AK",value: 10,color: '#0000ff'}]},{id:61,p:{x:1973.000000,y:551.000000,rad:20.00}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'},{label: "AK",value: 20,color: '#0000ff'}]},{id:14,p:{x:703.000000,y:610.000000,rad:16.00}, d:[{label: "BK",value: 24,color: '#ff0000'}]},{id:38,p:{x:1315.000000,y:669.000000,rad:16.66}, d:[{label: "BK",value: 6,color: '#ff0000'},{label: "AN",value: 20,color: '#00ff00'},{label: "AK",value: 5,color: '#0000ff'}]},{id:50,p:{x:1705.000000,y:551.000000,rad:17.33}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "AK",value: 20,color: '#0000ff'}]},{id:58,p:{x:1904.000000,y:551.000000,rad:18.33}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 10,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:11,p:{x:602.000000,y:542.000000,rad:18.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:47,p:{x:1520.000000,y:752.000000,rad:16.00}, d:[{label: "BN",value: 20,color: '#E67E22'}]},{id:54,p:{x:1852.000000,y:595.000000,rad:15.00}, d:[{label: "BN",value: 5,color: '#E67E22'}]},{id:53,p:{x:1800.000000,y:551.000000,rad:16.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "AK",value: 15,color: '#0000ff'}]},{id:52,p:{x:1664.000000,y:718.000000,rad:16.66}, d:[{label: "BN",value: 10,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'}]},{id:49,p:{x:1598.000000,y:711.000000,rad:17.33}, d:[{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'}]},{id:48,p:{x:1600.000000,y:551.000000,rad:17.33}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "AK",value: 20,color: '#0000ff'}]},{id:46,p:{x:1528.000000,y:663.000000,rad:16.00}, d:[{label: "AN",value: 20,color: '#00ff00'}]},{id:45,p:{x:1535.000000,y:553.000000,rad:17.33}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "AK",value: 20,color: '#0000ff'}]},{id:44,p:{x:1445.000000,y:722.000000,rad:15.66}, d:[{label: "BN",value: 15,color: '#E67E22'}]},{id:43,p:{x:1451.000000,y:663.000000,rad:15.66}, d:[{label: "AN",value: 15,color: '#00ff00'}]},{id:42,p:{x:1455.000000,y:553.000000,rad:16.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "AK",value: 15,color: '#0000ff'}]},{id:41,p:{x:1382.000000,y:623.000000,rad:18.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:37,p:{x:1123.000000,y:752.000000,rad:15.00}, d:[{label: "BK",value: 6,color: '#ff0000'}]},{id:33,p:{x:1238.000000,y:546.000000,rad:15.66}, d:[{label: "BN",value: 15,color: '#E67E22'}]},{id:32,p:{x:1232.000000,y:653.000000,rad:15.66}, d:[{label: "AN",value: 15,color: '#00ff00'}]},{id:31,p:{x:1066.000000,y:742.000000,rad:15.66}, d:[{label: "BK",value: 18,color: '#ff0000'}]},{id:30,p:{x:1072.000000,y:666.000000,rad:15.66}, d:[{label: "AK",value: 15,color: '#0000ff'}]},{id:29,p:{x:1079.000000,y:546.000000,rad:16.66}, d:[{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'}]},{id:28,p:{x:1008.000000,y:729.000000,rad:16.00}, d:[{label: "BK",value: 24,color: '#ff0000'}]},{id:27,p:{x:1008.000000,y:655.000000,rad:16.00}, d:[{label: "AK",value: 20,color: '#0000ff'}]},{id:26,p:{x:1016.000000,y:546.000000,rad:17.33}, d:[{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'}]},{id:25,p:{x:945.000000,y:715.000000,rad:15.66}, d:[{label: "BK",value: 18,color: '#ff0000'}]},{id:24,p:{x:947.000000,y:647.000000,rad:15.66}, d:[{label: "AK",value: 15,color: '#0000ff'}]},{id:23,p:{x:954.000000,y:544.000000,rad:16.66}, d:[{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'}]},{id:22,p:{x:882.000000,y:694.000000,rad:15.66}, d:[{label: "BK",value: 18,color: '#ff0000'}]},{id:21,p:{x:883.000000,y:634.000000,rad:15.66}, d:[{label: "AK",value: 15,color: '#0000ff'}]},{id:20,p:{x:886.000000,y:544.000000,rad:16.66}, d:[{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'}]},{id:19,p:{x:817.000000,y:668.000000,rad:15.66}, d:[{label: "BK",value: 18,color: '#ff0000'}]},{id:18,p:{x:819.000000,y:612.000000,rad:15.66}, d:[{label: "AK",value: 15,color: '#0000ff'}]},{id:17,p:{x:819.000000,y:544.000000,rad:16.66}, d:[{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'}]},{id:16,p:{x:756.000000,y:637.000000,rad:15.66}, d:[{label: "BK",value: 18,color: '#ff0000'}]},{id:13,p:{x:708.000000,y:542.000000,rad:18.66}, d:[{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'},{label: "AK",value: 20,color: '#0000ff'}]},{id:12,p:{x:657.000000,y:542.000000,rad:18.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:9,p:{x:490.000000,y:542.000000,rad:18.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:8,p:{x:433.000000,y:542.000000,rad:18.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:7,p:{x:373.000000,y:544.000000,rad:20.00}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'},{label: "AK",value: 20,color: '#0000ff'}]},{id:6,p:{x:309.000000,y:544.000000,rad:20.00}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'},{label: "AK",value: 20,color: '#0000ff'}]},{id:5,p:{x:247.000000,y:544.000000,rad:20.00}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'},{label: "AK",value: 20,color: '#0000ff'}]},{id:4,p:{x:192.000000,y:546.000000,rad:18.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:3,p:{x:137.000000,y:546.000000,rad:18.66}, d:[{label: "BK",value: 18,color: '#ff0000'},{label: "BN",value: 15,color: '#E67E22'},{label: "AN",value: 15,color: '#00ff00'},{label: "AK",value: 15,color: '#0000ff'}]},{id:2,p:{x:80.000000,y:546.000000,rad:20.00}, d:[{label: "BK",value: 24,color: '#ff0000'},{label: "BN",value: 20,color: '#E67E22'},{label: "AN",value: 20,color: '#00ff00'},{label: "AK",value: 20,color: '#0000ff'}]},{id:1,p:{x:28.000000,y:546.000000,rad:17.33}, d:[{label: "BK",value: 12,color: '#ff0000'},{label: "BN",value: 10,color: '#E67E22'},{label: "AN",value: 10,color: '#00ff00'},{label: "AK",value: 10,color: '#0000ff'}]}];

			// Load background image
			// If image is under same directory of the html file then use ./filename.png
			var background = new Image();
			background.src = "./dap.png";
			
			// Make sure the image is loaded first otherwise nothing will draw.
			background.onload = function(){
				var ctx = canvas.getContext('2d');
				ctx.drawImage(background,0,0,2062,271);

				var _offset = {x:0,y:777};
				for(k=0;k<data.length;k++){
				 	var position = data[k].p;
				 	drawPie(canvas, position, data[k].d, data[k].id, _offset);
				}

				// Save as png
				window.location = canvas.toDataURL("image/png");
			}
		</script>
	</body>

</html>

